\documentclass{article}

\input{../../definitions.tex}
\usepackage{diagbox}

\usepackage[numbers]{natbib}

\usepackage{fullpage}

\author{Alexey Beshenov (cadadr@gmail.com)}
\title{Números de Bernoulli y números de Stirling}
\date{2 de Marzo de 2017}

\usepackage{diagbox}
\usepackage{array}
\def\mystrut(#1,#2){\vrule height #1 depth #2 width 0pt}

\newcolumntype{f}[1]{%
>{\mystrut(3ex,2ex)\centering}%
p{#1}%
<{}}

\begin{document}

{\normalfont\sffamily\bfseries \maketitle}

\section*{Digresión combinatoria: los números de Stirling}

Nuestro próximo objetivo es obtener algunas expresiones para los números de Bernoulli que permitan estudiar sus propiedades aritméticas, específicamente sus numeradores y denominadores. En el camino surgen ciertos números combinatorios, conocidos como los \term{números de Stirling}.

\begin{definicion*}
Sean $k$ y $\ell$ dos números naturales positivos.

El \term{número de Stirling de primera clase} $\stirling{k}{\ell}$ es el número de permutaciones en el grupo simétrico $S_k$ que consisten en $\ell$ ciclos disjuntos.

El \term{número de Stirling de segunda clase} $\Stirling{k}{\ell}$ es el número de posibilidades de escribir un conjunto de $k$ elementos como una unión disjunta de $\ell$ conjuntos no vacíos.
\end{definicion*}

\begin{ejemplo*}
$\stirling{4}{2} = 11$. Las permutaciones correspondientes en $S_4$ son

\begin{gather*}
(1)\,(2~3~4), ~ (1)\,(2~4~3), ~ (2)\,(1~3~4), ~ (2)\,(1~4~3),\\
(3)\,(1~2~4), ~ (3)\,(1~4~2), ~ (4)\,(1~2~3), ~ (4)\,(1~3~2),\\
(1~2)\,(3~4), ~ (1~3)\,(2~4), ~ (1~4)\,(2~3).
\end{gather*}
\end{ejemplo*}

\begin{ejemplo*}
$\Stirling{4}{2} = 7$. Las descomposiciones de conjuntos correspondientes son

\begin{align*}
\{ 1,2,3,4 \} & = \{ 1 \} \cup \{ 2,3,4 \} = \{ 2 \} \cup \{ 1,3,4 \} = \{ 3 \} \cup \{ 1,2,4 \} = \{ 4 \} \cup \{ 1,2,3 \} \\
 & = \{ 1,2 \} \cup \{ 3,4 \} = \{ 1,3 \} \cup \{ 2,4 \} = \{ 1,4 \} \cup \{ 2,3 \}.
\end{align*}
\end{ejemplo*}

\pagebreak

De la definición se siguen las identidades

\begin{align}
\label{eqn:stirling-I-0} \stirling{k}{\ell} & = 0 \quad\text{para }\ell > k,\\
\label{eqn:stirling-I-1} \stirling{k}{k} & = 1,\\
\label{eqn:stirling-I-2} \stirling{k}{1} & = (k-1)!,\\
\label{eqn:stirling-I-3} \sum_{1 \le \ell \le k} \stirling{k}{\ell} & = k!,\\
\label{eqn:stirling-I-recur} \stirling{k+1}{\ell} & = \stirling{k}{\ell-1} + k\,\stirling{k}{\ell},
\end{align}

\begin{align}
\label{eqn:stirling-II-0} \Stirling{k}{\ell} & = 0 \quad\text{para }\ell > k,\\
\label{eqn:stirling-II-1} \Stirling{k}{k} & = 1,\\
\label{eqn:stirling-II-2} \Stirling{k}{1} & = 1,\\
\label{eqn:stirling-II-3} \sum_{1 \le \ell \le k} \Stirling{k}{\ell} & = b (k),\\
\label{eqn:stirling-II-recur} \Stirling{k+1}{\ell} & = \Stirling{k}{\ell-1} + \ell\,\Stirling{k}{\ell}.
\end{align}

\eqnref{eqn:stirling-I-1} significa que la única permutación en $S_k$ que se descompone en el producto de $k$ ciclos disjuntos es la permutación identidad. \eqnref{eqn:stirling-I-2} significa que en $S_k$ hay $(k-1)!$ diferentes $k$-ciclos (¿por qué?).

\eqnref{eqn:stirling-I-3} es el hecho de que toda permutación puede descomponerse en un producto de ciclos disjuntos. \eqnref{eqn:stirling-II-3} es el análogo de esta identidad: el número total de particiones se conoce como el \term{número de Bell} $b (k)$. Los primeros números de Bell son $b (1) = 1$, $b (2) = 2$, $b (3) = 5$, $b (4) = 15$, $b (5) = 52$, $b (6) = 203$, $\ldots$; véase \url{http://oeis.org/A000110} En este curso, no vamos estudiar estos números (también porque la notación parece mucho a los números de Bernoulli :-)

Las recurrencias \eqnref{eqn:stirling-I-recur} y \eqnref{eqn:stirling-II-recur} se siguen de la definición combinatoria. Por ejemplo, en \eqnref{eqn:stirling-I-recur}, consideremos las permutaciones de elementos $\{ 1, \ldots, k, k+1 \}$. Sea $\sigma \in S_{k+1}$ una permutación que se descompone en el producto de $\ell$ ciclos disjuntos. Si $\sigma (k+1) = k+1$, entonces $(k+1)$ forma un ciclo por sí mismo, y para el resto de los elementos hay $\stirling{k}{\ell-1}$ posibles descomposiciones. Si $\sigma (k+1) \ne k+1$, entonces $k+1$ pertenece a algún ciclo. Para enumerar todas las posibilidades, podemos primero considerar $\stirling{k}{\ell}$ descomposiciones de las permutaciones de $\{ 1,\ldots,k \}$ en $\ell$ ciclos disjuntos, y luego para cada descomposición hay $k$ posibilidades de poner $k+1$ en uno de los ciclos. La fórmula \eqnref{eqn:stirling-II-recur} se explica de la misma manera: si tenemos un conjunto $X$ de $k+1$ elementos, podemos considerar un elemento $x\in X$. Para las descomposiciones de $X$ en la unión de $\ell$ subconjuntos hay dos casos: o bien $\{ x \}$ forma un conjunto en la descomposición, y quedan $\Stirling{k}{\ell-1}$ posibilidades para descomponer $X\setminus \{ x \}$; o bien $x$ pertenece a algún conjunto. En el segundo caso, hay $\Stirling{k}{\ell}$ posibilidades de descomponer $X\setminus \{ x \}$ en $\ell$ subconjuntos, y luego en cada caso hay $\ell$ posibilidades de poner $x$ en uno de los conjuntos.

\pagebreak

También será útil definir $\stirling{k}{\ell}$ y $\Stirling{k}{\ell}$ para $k,\ell = 0$:

\begin{definicion*}
\label{numeros-de-stirling-para-0}
\begin{gather*}
\stirling{0}{0} = 1, \quad \stirling{k}{0} = \stirling{0}{\ell} = 0 \text{ para }k,\ell\ne 0,\\
\Stirling{0}{0} = 1, \quad \Stirling{k}{0} = \Stirling{0}{\ell} = 0 \text{ para }k,\ell\ne 0.
\end{gather*}
\end{definicion*}

Podemos definir $\stirling{k}{\ell}$ y $\Stirling{k}{\ell}$ por los valores iniciales de arriba y las relaciones de recurrencia \eqnref{eqn:stirling-I-recur} y \eqnref{eqn:stirling-II-recur}. Esta definición es compatible con la primera. Por ejemplo, en el caso de $\stirling{k}{\ell}$, podemos ver que las identidades
$$\stirling{0}{0} = 1, \quad \stirling{k}{0} = \stirling{0}{\ell} = 0 \text{ para }k,\ell\ne 0$$
implican
$$\stirling{k}{1} = (k-1)! \text{ para }k \ge 1, \quad \stirling{1}{\ell} = 0 \text{ para }\ell \ge 1.$$
En efecto,

\begin{align*}
\stirling{k}{1} & = \underbrace{\stirling{k}{0}}_0 + (k-1)\,\stirling{k-1}{1} = (k-1)\,(k-2)\,\stirling{k-2}{1} = \cdots \\
 & = (k-1)\,(k-2)\cdots 2\cdot 1 \, \Bigg(\underbrace{\stirling{0}{0}}_1 + \underbrace{\stirling{0}{1}}_0 \Bigg) = (k-1)!
\end{align*}

\noindent y para $\ell > 1$
$$\stirling{1}{\ell} = \stirling{0}{\ell-1} + 0\cdot \stirling{0}{\ell} = 0.$$

\begin{shaded}
\small\noindent En PARI/GP, \verb|stirling(k,l,2)| $= \Stirling{k}{\ell}$ (el parametro ``$2$'' significa ``de segunda clase''):

\begin{verbatim}
? stirling (4,2,2)
% = 7
\end{verbatim}

\noindent PARI/GP usa otra definición de los números de Stirling de primera clase. La única diferencia es el signo: \verb|stirling(k,l)| $= (-1)^{k-\ell} \stirling{k}{\ell}$:

\begin{verbatim}
? stirling (4,2)  
% = 11
? stirling(4,3)  
% = -6
\end{verbatim}
\end{shaded}

\begin{ejercicio*}
Demuestre que $\stirling{k}{k-1} = {k \choose 2}$.
\end{ejercicio*}

\begin{ejercicio*}
Note que las recurrencias de arriba con los valores iniciales para $k, \ell = 0$ nos permiten definir $\stirling{k}{\ell}$ y $\Stirling{k}{\ell}$ para todo $k,\ell \in \ZZ$. Demuestre que
$$\stirling{k}{\ell} = \Stirling{-\ell}{-k}.$$
Esto significa que los números de Stirling de primera y de segunda clase son esencialmente el mismo objeto.
\end{ejercicio*}

\begin{ejercicio*}
Demuestre que $\Stirling{k}{\ell} = 0$ para $k\ell < 0$.
\end{ejercicio*}

\noindent (Los últimos dos ejercicios sirven solo para acostumbrarse a las recurrencias con $\stirling{k}{\ell}$ y $\Stirling{k}{\ell}$; no vamos a usar los números de Stirling para $k$ y $\ell$ negativos.)

\vspace{1em}

\begin{center}
{\small
\noindent\begin{tabular}{|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|}
\hline
\backslashbox{$k$}{$\ell$} & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ \tabularnewline\hline
$0$ & $1$ &  &  &  &  &  &  &  &  & \tabularnewline\hline
$1$ & $0$ & $1$ &  &  &  &  &  &  &  & \tabularnewline\hline
$2$ & $0$ & $1$ & $1$ &  &  &  &  &  &  & \tabularnewline\hline
$3$ & $0$ & $2$ & $3$ & $1$ &  &  &  &  &  & \tabularnewline\hline
$4$ & $0$ & $6$ & $11$ & $6$ & $1$ &  &  &  &  & \tabularnewline\hline
$5$ & $0$ & $24$ & $50$ & $35$ & $10$ & $1$ &  &  &  & \tabularnewline\hline
$6$ & $0$ & $120$ & $274$ & $225$ & $85$ & $15$ & $1$ &  &  & \tabularnewline\hline
$7$ & $0$ & $720$ & $1764$ & $1624$ & $735$ & $175$ & $21$ & $1$ &  & \tabularnewline\hline
$8$ & $0$ & $5040$ & $13068$ & $13132$ & $6769$ & $1960$ & $322$ & $28$ & $1$ & \tabularnewline\hline
$9$ & $0$ & $40320$ & $109584$ & $118124$ & $67284$ & $22449$ & $4536$ & $546$ & $36$ & $1$ \tabularnewline\hline
\end{tabular}}

\vspace{1em}

\noindent Valores de $\stirling{k}{\ell}$

\vspace{\fill}

{\small
\noindent\begin{tabular}{|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|f{0.9cm}|}
\hline
\backslashbox{$k$}{$\ell$} & $0$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$ & $9$ \tabularnewline\hline
$0$ & $1$ &  &  &  &  &  &  &  &  & \tabularnewline\hline
$1$ & $0$ & $1$ &  &  &  &  &  &  &  & \tabularnewline\hline
$2$ & $0$ & $1$ & $1$ &  &  &  &  &  &  & \tabularnewline\hline
$3$ & $0$ & $1$ & $3$ & $1$ &  &  &  &  &  & \tabularnewline\hline
$4$ & $0$ & $1$ & $7$ & $6$ & $1$ &  &  &  &  & \tabularnewline\hline
$5$ & $0$ & $1$ & $15$ & $25$ & $10$ & $1$ &  &  &  & \tabularnewline\hline
$6$ & $0$ & $1$ & $31$ & $90$ & $65$ & $15$ & $1$ &  &  & \tabularnewline\hline
$7$ & $0$ & $1$ & $63$ & $301$ & $350$ & $140$ & $21$ & $1$ &  & \tabularnewline\hline
$8$ & $0$ & $1$ & $127$ & $966$ & $1701$ & $1050$ & $266$ & $28$ & $1$ & \tabularnewline\hline
$9$ & $0$ & $1$ & $255$ & $3025$ & $7770$ & $6951$ & $2646$ & $462$ & $36$ & $1$ \tabularnewline\hline
\end{tabular}}

\vspace{1em}

\noindent Valores de $\Stirling{k}{\ell}$
\end{center}

\pagebreak

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

\section*{Relación entre $B_k$ y los números de Stirling}

\begin{lema*}
\label{exp-stirling}
Para todo $\ell \ge 0$
$$\frac{(e^t - 1)^\ell}{\ell!} = \sum_{k \ge \ell} \Stirling{k}{\ell}\,\frac{t^k}{k!}.$$

\begin{proof}
Tenemos que verificar que
$$\frac{d^k}{dt^k} \left(\frac{(e^t - 1)^\ell}{\ell!}\right) (0) = \Stirling{k}{\ell}.$$
Los valores iniciales coinciden, y va a ser suficiente demostrar que la recurrencia
$$\Stirling{k+1}{\ell} = \Stirling{k}{\ell-1} + \ell \, \Stirling{k}{\ell}$$
se cumple en nuestro caso:
$$\frac{d^{k+1}}{dt^{k+1}} \left(\frac{(e^t - 1)^\ell}{\ell!}\right) (0) = \frac{d^k}{dt^k} \left(\frac{(e^t - 1)^{\ell-1}}{(\ell-1)!}\right) (0) + \ell\,\frac{d^k}{dt^k} \left(\frac{(e^t - 1)^\ell}{\ell!}\right) (0).$$
En efecto,

\begin{align*}
\frac{d^{k+1}}{dt^{k+1}} \left(\frac{(e^t - 1)^\ell}{\ell!}\right) & = \frac{d^k}{dt^k} \left(\frac{(e^t - 1)^{\ell-1}}{(\ell-1)!}\,e^t\right) = \frac{d^k}{dt^k} \left(\frac{(e^t - 1)^{\ell-1} \, (1 + e^t - 1)}{(\ell - 1)!}\right) \\
 & = \frac{d^k}{dt^k} \left(\frac{(e^t - 1)^{\ell-1}}{(\ell-1)!} + \frac{(e^t-1)^\ell}{(\ell-1)!}\right) \\
 & = \frac{d^k}{dt^k} \left(\frac{(e^t - 1)^{\ell-1}}{(\ell-1)!}\right) + \ell\,\frac{d^k}{dt^k} \left(\frac{(e^t-1)^\ell}{\ell!}\right).
\end{align*}
\end{proof}
\end{lema*}

\begin{ejercicio*}
\label{log-stirling}
Demuestre la identidad
$$\frac{(-\ln (1-t))^\ell}{\ell!} = \sum_{k \ge \ell} \stirling{k}{\ell}\,\frac{t^k}{k!}.$$
(De nuevo, es suficiente considerar las derivadas formales y verificar que se cumple la misma recurrencia que define los números de Stirling correspondientes: $\stirling{k+1}{\ell} = \stirling{k}{\ell-1} + k\,\stirling{k}{\ell}$.)
\end{ejercicio*}

Lo que acabamos de ver son las funciones generatrices para los números de Stirling, pero no soy tan sádico para dar esto como la definición de $\Stirling{k}{\ell}$ y $\stirling{k}{\ell}$.

\begin{lema*}
\label{stirling-via-binomial}
Para $k,\ell\ge 0$
$$\Stirling{k}{\ell} = \frac{(-1)^\ell}{\ell!}\,\sum_{0 \le i \le \ell} (-1)^i \, {\ell \choose i} \, i^k.$$

\begin{proof}
De nuevo, podemos verificar que los valores iniciales coinciden y la suma satisface la misma recurrencia que $\Stirling{k}{\ell}$:
$$\Stirling{k+1}{\ell} = \Stirling{k}{\ell-1} + \ell \, \Stirling{k}{\ell}.$$
Para los valores iniciales, si $k = \ell = 0$, la suma nos da $\Stirling{0}{0} = 1$ (como siempre en el contexto algebraico/combinatorio, $0^0 = 1$); si $k > 0$, $\ell = 0$, la suma nos da $0$; si $k = 0$, $\ell > 0$, la suma también nos da $\sum_{0 \le i \le \ell} (-1)^i \, {\ell\choose i} = 0$. Para la recurrencia,

\begin{align*}
\frac{(-1)^\ell}{\ell!}\,\sum_{0 \le i \le \ell} (-1)^i \, {\ell \choose i} \, i^{k+1} & = \frac{(-1)^\ell}{(\ell-1)!}\,\sum_{0 \le i \le \ell} (-1)^i \, \frac{i}{\ell}\, {\ell \choose i} \, i^k \\
 & = \frac{(-1)^\ell}{(\ell-1)!}\,\sum_{0 \le i \le \ell} (-1)^i \, \left({\ell \choose i} - {\ell - 1\choose i}\right) \, i^k \\
 & = \frac{(-1)^{\ell-1}}{(\ell-1)!}\,\sum_{0 \le i \le \ell-1} (-1)^i \, {\ell - 1 \choose i} \, i^k + \ell\,\frac{(-1)^\ell}{\ell!}\,\sum_{0 \le i \le \ell} (-1)^i \, {\ell \choose i} \, i^k.
\end{align*}

Aquí hemos usado la identidad
$${\ell \choose i} - {\ell - 1 \choose i} = \frac{i}{\ell}\,{\ell \choose i}.$$
\end{proof}
\end{lema*}

\begin{teorema*}
$$B_k = (-1)^k \, \sum_{0 \le \ell \le k} \frac{(-1)^\ell \, \ell! \, \Stirling{k}{\ell}}{\ell+1} = (-1)^k \, \sum_{0 \le \ell \le k} \frac{1}{\ell+1}\,\sum_{0 \le i \le \ell} (-1)^i \, {\ell \choose i} \, i^k.$$
\end{teorema*}

La segunda igualdad viene de la expresión de los números de Stirling en términos de los coeficientes binomiales y (¡por fin!) nos da una expresión para $B_k$ sin recurrencias.

\begin{proof}
La función generatriz para $B_k$ es $\frac{t\,e^t}{e^t - 1}$. Ya que la exponencial y el logaritmo formales son inversos, podemos escribir
$$\frac{t\,e^t}{e^t - 1} = \frac{t}{1 - e^{-t}} = \frac{-\ln (1 - (1-e^{-t}))}{1 - e^{-t}}.$$
Luego,

\begin{align*}
\frac{-\ln (1 - (1-e^{-t}))}{1 - e^{-t}} & = \frac{1}{1 - e^{-t}}\,\sum_{\ell \ge 1} \frac{(1 - e^{-t})^\ell}{\ell} \\
 & = \sum_{\ell \ge 1} \frac{(1 - e^{-t})^{\ell-1}}{\ell} \\
 & = \sum_{\ell \ge 0} \frac{(-1)^\ell\,\ell!}{\ell+1} \sum_{k \ge \ell} \Stirling{k}{\ell}\,\frac{(-t)^k}{k!} \quad\text{por \ref{exp-stirling}} \\
 & = \sum_{k \ge 0} (-1)^k \left(\sum_{0\le \ell \le k} \frac{(-1)^\ell\,\ell! \, \Stirling{k}{\ell}}{\ell+1}\right)\,\frac{t^k}{k!}.
\end{align*}
\end{proof}

\begin{shaded}
\small
\begin{verbatim}
? bernbin (k) = (-1)^k * sum (l=0,k, 1/(l+1)*sum(i=0,l, (-1)^i*binomial(l,i)*i^k));
? vector (10,k,bernbin(k))                                                         
% = [1/2, 1/6, 0, -1/30, 0, 1/42, 0, -1/30, 0, 5/66]
\end{verbatim}
\end{shaded}

\end{document}
